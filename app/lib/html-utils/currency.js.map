{"version":3,"file":"currency.js","names":["_lodash","require","_logger","_interopRequireDefault","_CurrencyFormatter","obj","__esModule","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","descriptor","configurable","writable","_toPropertyKey","key","_createClass","protoProps","staticProps","prototype","value","_toPrimitive","_typeof","String","Symbol","toPrimitive","call","Number","_classStaticPrivateFieldSpecGet","receiver","classConstructor","_classCheckPrivateStaticAccess","_classCheckPrivateStaticFieldDescriptor","_classApplyDescriptorGet","action","undefined","get","_classStaticPrivateMethodGet","method","SYMBOLS","CurrencyFormatter","exports","formatSymboled","amount","currency","options","formatter","_get","formatUnsymboled","formatNamed","formatDefault","DEFAULT","isPlainObject","_key","isEmpty","_formatters","_create","JSON","stringify","_createStandard","_unused","_createCustom","fSymboled","Intl","NumberFormat","style","currencyDisplay","fCoded","replace","format","RegExp","concat","logger","info","fDefault"],"sources":["../../../src/lib/html-utils/currency.js"],"sourcesContent":["import { replace, isPlainObject, isEmpty } from 'lodash'\n\nimport logger from '@lib/logger'\n\nconst SYMBOLS = {\n  'WETH': 'Ξ',\n  'WBTC': '₿',\n}\n\nexport class CurrencyFormatter {\n  static #formatters = {}\n  static DEFAULT = ''\n\n  static formatSymboled(amount, currency, options) {\n    const formatter = CurrencyFormatter.#get(currency, options)\n    return formatter.formatSymboled(amount)\n  }\n\n  static formatUnsymboled(amount, currency, options) {\n    const formatter = CurrencyFormatter.#get(currency, options)\n    return formatter.formatUnsymboled(amount)\n  }\n\n  static formatNamed(amount, currency, options) {\n    const formatter = CurrencyFormatter.#get(currency, options)\n    return formatter.formatNamed(amount)\n  }\n\n  static formatDefault(amount, options) {\n    const formatter = CurrencyFormatter.#get(CurrencyFormatter.DEFAULT, options)\n    return formatter.formatUnsymboled(amount)\n  }\n\n  static #get(currency, options) {\n    options = isPlainObject(options) ? options : {}\n    const key = CurrencyFormatter.#key(currency, options)\n    if (isEmpty(CurrencyFormatter.#formatters[key])) {\n      CurrencyFormatter.#formatters[key] = CurrencyFormatter.#create(currency, options)\n    }\n    return CurrencyFormatter.#formatters[key]\n  }\n\n  static #key(currency, options) {\n    return JSON.stringify({ currency, ...options })\n  }\n\n  static #create(currency, options) {\n    try {\n      return CurrencyFormatter.#createStandard(currency, options)\n    } catch {\n      return CurrencyFormatter.#createCustom(currency, options)\n    }\n  }\n\n  static #createStandard(currency, options) {\n    const fSymboled = new Intl.NumberFormat(undefined, {\n      style: 'currency',\n      currency,\n      currencyDisplay: 'narrowSymbol',\n      ...options,\n    })\n\n    const fCoded = new Intl.NumberFormat(undefined, {\n      style: 'currency',\n      currency,\n      currencyDisplay: 'code',\n      ...options,\n    })\n\n    const formatter = {\n      formatUnsymboled: (amount) => replace(fCoded.format(amount), new RegExp(`\\s+${currency}\\s+`), ''),\n      formatSymboled: (amount) => fSymboled.format(amount),\n      formatNamed: (amount) => fCoded.format(amount),\n    }\n\n    logger.info('Standard Currency Formatter Create: \"%s\"', currency)\n\n    return formatter\n\n  }\n\n  static #createCustom(currency, options) {\n    const fDefault = new Intl.NumberFormat(undefined, {\n      style: 'currency',\n      currency: 'USD',\n      currencyDisplay: 'code',\n      ...options,\n    })\n\n    const formatter = {\n      formatUnsymboled: (amount) => replace(fDefault.format(amount), /\\s*[$USD]+\\s*/, ''),\n      formatSymboled: (amount) => replace(fDefault.format(amount), /[$USD]+/, (SYMBOLS[currency] || '')),\n      formatNamed: (amount) => replace(fDefault.format(amount), /[$USD]+/, (currency || '')),\n    }\n\n    logger.info('Custom Currency Formatter Create: \"%s\"', currency || 'DEFAULT')\n\n    return formatter\n\n  }\n\n}\n\n"],"mappings":"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"}