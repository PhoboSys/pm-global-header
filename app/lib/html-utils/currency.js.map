{"version":3,"file":"currency.js","names":["_lodash","require","_logger","_interopRequireDefault","_class","obj","__esModule","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","descriptor","configurable","writable","_toPropertyKey","key","_createClass","protoProps","staticProps","prototype","value","arg","_toPrimitive","_typeof","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","Number","_classStaticPrivateFieldSpecGet","receiver","classConstructor","_classCheckPrivateStaticAccess","_classCheckPrivateStaticFieldDescriptor","_classApplyDescriptorGet","action","get","_classStaticPrivateMethodGet","method","SYMBOLS","CurrencyFormatter","formatSymboled","amount","currency","options","formatter","_get","formatUnsymboled","formatNamed","formatDefault","DEFAULT","exports","isPlainObject","_key","isEmpty","_formatters","_create","JSON","stringify","_createStandard","_unused","_createCustom","fSymboled","Intl","NumberFormat","style","currencyDisplay","fCoded","replace","format","RegExp","concat","logger","info","fDefault"],"sources":["../../../src/lib/html-utils/currency.js"],"sourcesContent":["import { replace, isPlainObject, isEmpty } from 'lodash'\n\nimport logger from '@lib/logger'\n\nconst SYMBOLS = {\n  'WETH': 'Ξ',\n  'WBTC': '₿',\n}\n\nexport class CurrencyFormatter {\n  static #formatters = {}\n  static DEFAULT = ''\n\n  static formatSymboled(amount, currency, options) {\n    const formatter = CurrencyFormatter.#get(currency, options)\n    return formatter.formatSymboled(amount)\n  }\n\n  static formatUnsymboled(amount, currency, options) {\n    const formatter = CurrencyFormatter.#get(currency, options)\n    return formatter.formatUnsymboled(amount)\n  }\n\n  static formatNamed(amount, currency, options) {\n    const formatter = CurrencyFormatter.#get(currency, options)\n    return formatter.formatNamed(amount)\n  }\n\n  static formatDefault(amount, options) {\n    const formatter = CurrencyFormatter.#get(CurrencyFormatter.DEFAULT, options)\n    return formatter.formatUnsymboled(amount)\n  }\n\n  static #get(currency, options) {\n    options = isPlainObject(options) ? options : {}\n    const key = CurrencyFormatter.#key(currency, options)\n    if (isEmpty(CurrencyFormatter.#formatters[key])) {\n      CurrencyFormatter.#formatters[key] = CurrencyFormatter.#create(currency, options)\n    }\n    return CurrencyFormatter.#formatters[key]\n  }\n\n  static #key(currency, options) {\n    return JSON.stringify({ currency, ...options })\n  }\n\n  static #create(currency, options) {\n    try {\n      return CurrencyFormatter.#createStandard(currency, options)\n    } catch {\n      return CurrencyFormatter.#createCustom(currency, options)\n    }\n  }\n\n  static #createStandard(currency, options) {\n    const fSymboled = new Intl.NumberFormat(undefined, {\n      style: 'currency',\n      currency,\n      currencyDisplay: 'narrowSymbol',\n      ...options,\n    })\n\n    const fCoded = new Intl.NumberFormat(undefined, {\n      style: 'currency',\n      currency,\n      currencyDisplay: 'code',\n      ...options,\n    })\n\n    const formatter = {\n      formatUnsymboled: (amount) => replace(fCoded.format(amount), new RegExp(`\\s+${currency}\\s+`), ''),\n      formatSymboled: (amount) => fSymboled.format(amount),\n      formatNamed: (amount) => fCoded.format(amount),\n    }\n\n    logger.info('Standard Currency Formatter Create: \"%s\"', currency)\n\n    return formatter\n\n  }\n\n  static #createCustom(currency, options) {\n    const fDefault = new Intl.NumberFormat(undefined, {\n      style: 'currency',\n      currency: 'USD',\n      currencyDisplay: 'code',\n      ...options,\n    })\n\n    const formatter = {\n      formatUnsymboled: (amount) => replace(fDefault.format(amount), /\\s*[$USD]+\\s*/, ''),\n      formatSymboled: (amount) => replace(fDefault.format(amount), /[$USD]+/, (SYMBOLS[currency] || '')),\n      formatNamed: (amount) => replace(fDefault.format(amount), /[$USD]+/, (currency || '')),\n    }\n\n    logger.info('Custom Currency Formatter Create: \"%s\"', currency || 'DEFAULT')\n\n    return formatter\n\n  }\n\n}\n\n"],"mappings":"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"}