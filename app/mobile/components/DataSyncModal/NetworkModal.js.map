{"version":3,"file":"NetworkModal.js","names":["_react","_interopRequireDefault","require","_lodash","_clsx","_constants","_CloseIcon","_Sync","_WiFiWarning","_Button","_dateUtils","_htmlUtils","_hooks","_state","_getters","_DataSyncModalModule","e","__esModule","_typeof","o","Symbol","iterator","constructor","prototype","_defineProperty","r","t","_toPropertyKey","Object","defineProperty","value","enumerable","configurable","writable","i","_toPrimitive","toPrimitive","call","TypeError","String","Number","modalClasses","base","css","overlayBase","ContentModal","_ref","_ref$bcblock","bcblock","_ref$latestprice","latestprice","networkStatus","close","_useTranslation","useTranslation","isEmpty","NETWORK_STATUS","SUCCESS","blockAge","formatDistanceUnixTS","timestamp","blockNumber","number","priceAge","price","htmlCurrentySymboled","createElement","className","container","onClick","content","cn","wifi","error","ERROR","warning","WARNING","description","table","row","name","DataSyncModal","_ref2","_useModal","useModal","type","Content","hideClose","modal","isOpen","open","useScheduledCommand","_default","exports","connect","state","getLatestbcBlock","getActiveGameChartDateLatestPrice","getNetworkStatus","React","memo"],"sources":["../../../../src/mobile/components/DataSyncModal/NetworkModal.js"],"sourcesContent":["import React from 'react'\nimport { isEmpty } from 'lodash'\nimport cn from 'clsx'\n\nimport { NETWORK_STATUS } from '@constants'\nimport CloseIcon from '@components/SVG/CloseIcon'\nimport Sync from '@components/SVG/Sync'\nimport WiFiWarning from '@components/SVG/WiFiWarning'\nimport Button from '@components/common/Button'\nimport { formatDistanceUnixTS } from '@lib/date-utils'\nimport { htmlCurrentySymboled } from '@lib/html-utils'\nimport { useScheduledCommand, useTranslation, useModal } from '@hooks'\nimport { connect } from '@state'\nimport { getActiveGameChartDateLatestPrice } from '@state/getters'\nimport { getLatestbcBlock, getNetworkStatus } from '@state/getters'\n\nimport css from './DataSyncModal.module.scss'\n\nconst modalClasses = { base: css.overlayBase }\n\nconst ContentModal = ({ bcblock = {}, latestprice = {}, networkStatus, close }) => {\n  const { t } = useTranslation()\n\n  if (isEmpty(bcblock)) return null\n  if (isEmpty(latestprice)) return null\n  if (!networkStatus) return null\n  if (networkStatus === NETWORK_STATUS.SUCCESS) return null\n\n  const blockAge = formatDistanceUnixTS(bcblock.timestamp)\n  const blockNumber = bcblock.number\n  const priceAge = formatDistanceUnixTS(latestprice.timestamp)\n  const price = htmlCurrentySymboled(latestprice.value, 'USD')\n\n  return (\n    <div className={css.container}>\n      <Button onClick={close} className={css.close}>\n        <CloseIcon />\n      </Button>\n      <div className={css.content}>\n        <div className={cn(css.wifi, {\n          [css.error]: networkStatus === NETWORK_STATUS.ERROR,\n          [css.warning]: networkStatus === NETWORK_STATUS.WARNING,\n        })}>\n          {networkStatus === NETWORK_STATUS.WARNING && <Sync />}\n          {networkStatus === NETWORK_STATUS.ERROR && <WiFiWarning />}\n        </div>\n        <div className={css.description}>\n          {networkStatus === NETWORK_STATUS.WARNING && t('Data is currently out of date. Please wait while it is syncing...')}\n          {networkStatus === NETWORK_STATUS.ERROR && t('Unable to sync data. Check internet connection')}\n        </div>\n        <div className={css.table}>\n\n          <div className={css.row}>\n            <div className={css.name}>{t('Block number')}</div>\n            <div className={css.value}>{blockNumber}</div>\n          </div>\n\n          <div className={css.row}>\n            <div className={css.name}>{t('Block age')}</div>\n            <div className={css.value}>{blockAge}</div>\n          </div>\n\n          <div className={css.row}>\n            <div className={css.name}>{t('Latest price')}</div>\n            <div className={css.value}>{price}</div>\n          </div>\n\n          <div className={css.row}>\n            <div className={css.name}>{t('Price age')}</div>\n            <div className={css.value}>{priceAge}</div>\n          </div>\n\n        </div>\n      </div>\n    </div>\n  )\n}\n\nconst DataSyncModal = ({ bcblock, latestprice, networkStatus }) => {\n\n  const { modal, isOpen, open, close } = useModal({\n    type: 'primary',\n    Content: ContentModal,\n    hideClose: true,\n    modalClasses,\n  })\n\n  useScheduledCommand(() => {\n    if (isEmpty(bcblock)) return\n    if (isEmpty(latestprice)) return\n\n    if (networkStatus === NETWORK_STATUS.WARNING || networkStatus === NETWORK_STATUS.ERROR) {\n      open({ bcblock, latestprice, networkStatus })\n    } else isOpen && close()\n  }, [isOpen, open, close, bcblock, latestprice, networkStatus])\n\n  return modal\n\n}\n\nexport default connect(\n  state => ({\n    bcblock: getLatestbcBlock(state),\n    latestprice: getActiveGameChartDateLatestPrice(state),\n    networkStatus: getNetworkStatus(state),\n  })\n)(React.memo(DataSyncModal))"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAD,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAEA,IAAAG,UAAA,GAAAH,OAAA;AACA,IAAAI,UAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,KAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,YAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,OAAA,GAAAR,sBAAA,CAAAC,OAAA;AACA,IAAAQ,UAAA,GAAAR,OAAA;AACA,IAAAS,UAAA,GAAAT,OAAA;AACA,IAAAU,MAAA,GAAAV,OAAA;AACA,IAAAW,MAAA,GAAAX,OAAA;AACA,IAAAY,QAAA,GAAAZ,OAAA;AAGA,IAAAa,oBAAA,GAAAd,sBAAA,CAAAC,OAAA;AAA6C,SAAAD,uBAAAe,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,gBAAAA,CAAA;AAAA,SAAAE,QAAAC,CAAA,sCAAAD,OAAA,wBAAAE,MAAA,uBAAAA,MAAA,CAAAC,QAAA,aAAAF,CAAA,kBAAAA,CAAA,gBAAAA,CAAA,WAAAA,CAAA,yBAAAC,MAAA,IAAAD,CAAA,CAAAG,WAAA,KAAAF,MAAA,IAAAD,CAAA,KAAAC,MAAA,CAAAG,SAAA,qBAAAJ,CAAA,KAAAD,OAAA,CAAAC,CAAA;AAAA,SAAAK,gBAAAR,CAAA,EAAAS,CAAA,EAAAC,CAAA,YAAAD,CAAA,GAAAE,cAAA,CAAAF,CAAA,MAAAT,CAAA,GAAAY,MAAA,CAAAC,cAAA,CAAAb,CAAA,EAAAS,CAAA,IAAAK,KAAA,EAAAJ,CAAA,EAAAK,UAAA,MAAAC,YAAA,MAAAC,QAAA,UAAAjB,CAAA,CAAAS,CAAA,IAAAC,CAAA,EAAAV,CAAA;AAAA,SAAAW,eAAAD,CAAA,QAAAQ,CAAA,GAAAC,YAAA,CAAAT,CAAA,gCAAAR,OAAA,CAAAgB,CAAA,IAAAA,CAAA,GAAAA,CAAA;AAAA,SAAAC,aAAAT,CAAA,EAAAD,CAAA,oBAAAP,OAAA,CAAAQ,CAAA,MAAAA,CAAA,SAAAA,CAAA,MAAAV,CAAA,GAAAU,CAAA,CAAAN,MAAA,CAAAgB,WAAA,kBAAApB,CAAA,QAAAkB,CAAA,GAAAlB,CAAA,CAAAqB,IAAA,CAAAX,CAAA,EAAAD,CAAA,gCAAAP,OAAA,CAAAgB,CAAA,UAAAA,CAAA,YAAAI,SAAA,yEAAAb,CAAA,GAAAc,MAAA,GAAAC,MAAA,EAAAd,CAAA;AAE7C,IAAMe,YAAY,GAAG;EAAEC,IAAI,EAAEC,+BAAG,CAACC;AAAY,CAAC;AAE9C,IAAMC,YAAY,GAAG,SAAfA,YAAYA,CAAAC,IAAA,EAAiE;EAAA,IAAAC,YAAA,GAAAD,IAAA,CAA3DE,OAAO;IAAPA,OAAO,GAAAD,YAAA,cAAG,CAAC,CAAC,GAAAA,YAAA;IAAAE,gBAAA,GAAAH,IAAA,CAAEI,WAAW;IAAXA,WAAW,GAAAD,gBAAA,cAAG,CAAC,CAAC,GAAAA,gBAAA;IAAEE,aAAa,GAAAL,IAAA,CAAbK,aAAa;IAAEC,KAAK,GAAAN,IAAA,CAALM,KAAK;EAC1E,IAAAC,eAAA,GAAc,IAAAC,qBAAc,EAAC,CAAC;IAAtB5B,CAAC,GAAA2B,eAAA,CAAD3B,CAAC;EAET,IAAI,IAAA6B,eAAO,EAACP,OAAO,CAAC,EAAE,OAAO,IAAI;EACjC,IAAI,IAAAO,eAAO,EAACL,WAAW,CAAC,EAAE,OAAO,IAAI;EACrC,IAAI,CAACC,aAAa,EAAE,OAAO,IAAI;EAC/B,IAAIA,aAAa,KAAKK,yBAAc,CAACC,OAAO,EAAE,OAAO,IAAI;EAEzD,IAAMC,QAAQ,GAAG,IAAAC,+BAAoB,EAACX,OAAO,CAACY,SAAS,CAAC;EACxD,IAAMC,WAAW,GAAGb,OAAO,CAACc,MAAM;EAClC,IAAMC,QAAQ,GAAG,IAAAJ,+BAAoB,EAACT,WAAW,CAACU,SAAS,CAAC;EAC5D,IAAMI,KAAK,GAAG,IAAAC,+BAAoB,EAACf,WAAW,CAACpB,KAAK,EAAE,KAAK,CAAC;EAE5D,oBACE9B,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACyB;EAAU,gBAC5BpE,MAAA,YAAAkE,aAAA,CAACzD,OAAA,WAAM;IAAC4D,OAAO,EAAEjB,KAAM;IAACe,SAAS,EAAExB,+BAAG,CAACS;EAAM,gBAC3CpD,MAAA,YAAAkE,aAAA,CAAC5D,UAAA,WAAS,MAAE,CACN,CAAC,eACTN,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAAC2B;EAAQ,gBAC1BtE,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAE,IAAAI,gBAAE,EAAC5B,+BAAG,CAAC6B,IAAI,EAAAhD,eAAA,CAAAA,eAAA,KACxBmB,+BAAG,CAAC8B,KAAK,EAAGtB,aAAa,KAAKK,yBAAc,CAACkB,KAAK,GAClD/B,+BAAG,CAACgC,OAAO,EAAGxB,aAAa,KAAKK,yBAAc,CAACoB,OAAO,CACxD;EAAE,GACAzB,aAAa,KAAKK,yBAAc,CAACoB,OAAO,iBAAI5E,MAAA,YAAAkE,aAAA,CAAC3D,KAAA,WAAI,MAAE,CAAC,EACpD4C,aAAa,KAAKK,yBAAc,CAACkB,KAAK,iBAAI1E,MAAA,YAAAkE,aAAA,CAAC1D,YAAA,WAAW,MAAE,CACtD,CAAC,eACNR,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACkC;EAAY,GAC7B1B,aAAa,KAAKK,yBAAc,CAACoB,OAAO,IAAIlD,CAAC,CAAC,mEAAmE,CAAC,EAClHyB,aAAa,KAAKK,yBAAc,CAACkB,KAAK,IAAIhD,CAAC,CAAC,gDAAgD,CAC1F,CAAC,eACN1B,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACmC;EAAM,gBAExB9E,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACoC;EAAI,gBACtB/E,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACqC;EAAK,GAAEtD,CAAC,CAAC,cAAc,CAAO,CAAC,eACnD1B,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACb;EAAM,GAAE+B,WAAiB,CAC1C,CAAC,eAEN7D,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACoC;EAAI,gBACtB/E,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACqC;EAAK,GAAEtD,CAAC,CAAC,WAAW,CAAO,CAAC,eAChD1B,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACb;EAAM,GAAE4B,QAAc,CACvC,CAAC,eAEN1D,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACoC;EAAI,gBACtB/E,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACqC;EAAK,GAAEtD,CAAC,CAAC,cAAc,CAAO,CAAC,eACnD1B,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACb;EAAM,GAAEkC,KAAW,CACpC,CAAC,eAENhE,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACoC;EAAI,gBACtB/E,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACqC;EAAK,GAAEtD,CAAC,CAAC,WAAW,CAAO,CAAC,eAChD1B,MAAA,YAAAkE,aAAA;IAAKC,SAAS,EAAExB,+BAAG,CAACb;EAAM,GAAEiC,QAAc,CACvC,CAEF,CACF,CACF,CAAC;AAEV,CAAC;AAED,IAAMkB,aAAa,GAAG,SAAhBA,aAAaA,CAAAC,KAAA,EAAgD;EAAA,IAA1ClC,OAAO,GAAAkC,KAAA,CAAPlC,OAAO;IAAEE,WAAW,GAAAgC,KAAA,CAAXhC,WAAW;IAAEC,aAAa,GAAA+B,KAAA,CAAb/B,aAAa;EAE1D,IAAAgC,SAAA,GAAuC,IAAAC,eAAQ,EAAC;MAC9CC,IAAI,EAAE,SAAS;MACfC,OAAO,EAAEzC,YAAY;MACrB0C,SAAS,EAAE,IAAI;MACf9C,YAAY,EAAZA;IACF,CAAC,CAAC;IALM+C,KAAK,GAAAL,SAAA,CAALK,KAAK;IAAEC,MAAM,GAAAN,SAAA,CAANM,MAAM;IAAEC,IAAI,GAAAP,SAAA,CAAJO,IAAI;IAAEtC,KAAK,GAAA+B,SAAA,CAAL/B,KAAK;EAOlC,IAAAuC,0BAAmB,EAAC,YAAM;IACxB,IAAI,IAAApC,eAAO,EAACP,OAAO,CAAC,EAAE;IACtB,IAAI,IAAAO,eAAO,EAACL,WAAW,CAAC,EAAE;IAE1B,IAAIC,aAAa,KAAKK,yBAAc,CAACoB,OAAO,IAAIzB,aAAa,KAAKK,yBAAc,CAACkB,KAAK,EAAE;MACtFgB,IAAI,CAAC;QAAE1C,OAAO,EAAPA,OAAO;QAAEE,WAAW,EAAXA,WAAW;QAAEC,aAAa,EAAbA;MAAc,CAAC,CAAC;IAC/C,CAAC,MAAMsC,MAAM,IAAIrC,KAAK,CAAC,CAAC;EAC1B,CAAC,EAAE,CAACqC,MAAM,EAAEC,IAAI,EAAEtC,KAAK,EAAEJ,OAAO,EAAEE,WAAW,EAAEC,aAAa,CAAC,CAAC;EAE9D,OAAOqC,KAAK;AAEd,CAAC;AAAA,IAAAI,QAAA,GAAAC,OAAA,cAEc,IAAAC,cAAO,EACpB,UAAAC,KAAK;EAAA,OAAK;IACR/C,OAAO,EAAE,IAAAgD,yBAAgB,EAACD,KAAK,CAAC;IAChC7C,WAAW,EAAE,IAAA+C,0CAAiC,EAACF,KAAK,CAAC;IACrD5C,aAAa,EAAE,IAAA+C,yBAAgB,EAACH,KAAK;EACvC,CAAC;AAAA,CACH,CAAC,eAACI,iBAAK,CAACC,IAAI,CAACnB,aAAa,CAAC,CAAC","ignoreList":[]}